title: deepcf系列
author: nullfan
date: 2019-10-24 10:27:06
tags:
---
## DeepCF一期：基于语义的DeepCF  
#### 概述
首先根据语义模型训练，获取意图词的embedding, 然后用户对意图词的展点情况，获取用户-意图词的评分矩阵。最后根据已获得的意图词embedding进行矩阵分解，获得user embedding, 进行user-user的ANN检索，找到相似用户，进而进行推荐  
#### 语义模型训练与user-item矩阵求解。
首先，利用自然语料对所有的item进行预训练，得到所有item的embedding。然后，基于item embedding向量使用最小二乘法，对于每个user可以计算出128维的向量。最终得到的用户向量低维且稠密，而且也通过item的语义信息引入对user间建立了更多的关联。  
![](/imgs/deepcf_user_vec.png)
#### 分布式ANN索引  
由于索引数据有一个亿，单个机器内存无法存储，且运行时间较慢； 实际操作过程中，将一亿的数据分成20份，分别单独建立ANN索引； 对于每个用户，将20个ANN索引数的结果merge到一起，作为该用户的近邻用户  

## DeepCF二期：基于item2vec的广告推荐
#### 项目简介  
##### 广告关联定义
* 同一用户，在不超过一周的时间间隔内点击过的两个广告，定义为潜在关联广告。  

##### 训练样本准备
* (1)选取广告标题和广告主体信息，以及广告所属一级、二级、三级行业等特征，来表达一条广告。
* (2) 网络基于pair-wise方式设计，分别获取item1与item2、item1与item3的关联度量（距离度量），通过rank-loss迭代优化模型  

##### 广告推荐逻辑
* 离线利用DNN网络隐层，将所有广告库中的广告向量化  

## DeepCF三期：基于user2ad的广告推荐  
#### 样本准备
* 正例样本，用户与该用户点击广告对作为一个正例
* 负例样本，在所有正例样本中出现的广告，随机抽样产生负例样本。每一个正例的用户，会通过随机抽样方式产生15个负例  

#### 模型设计
* 选取用户画像信息，以及从用户历史搜索、广告点击和feed资讯浏览等长期行为数据挖掘的特征，来刻画一个用户。  
* 选取广告创意信息，主体信息，以及广告所属一级、二级、三级行业等特征，来表达一条广告。 
* 分别获取用户和广告的向量表达，并利用关联度量（距离度量）拟合用户实际点击行为   

## DeepCF四期：基于user2intent的意图推荐  
#### user2intent协同矩阵构建  
* 对用户过去7天的搜索、浏览、广告点击行为使用翻译模型处理成intent，并在user-intent矩阵中对这部分intent标注为1  
* 对其余intent标注为0，生成如下图所示的user-intent协同矩阵  
* 模型训练样本准备：从user-intent协同矩阵中提取模型训练样本，其中对标注为0的样本随机抽样  
## DeepCF五期：基于频次分布的采样优化  
* 基于频率负例抽样
  ![](/imgs/deepcf_v5.png)  
  
## DeepCF九期  

  ![](/imgs/deepcf_v9.png)  
  ![](/imgs/deepcf_v9_2.png)  
## DeepCF十期：基于点击咨询的pretrain模型 

![](/imgs/deepcf_v10.png)  
